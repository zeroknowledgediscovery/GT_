\begin{tikzpicture}[scale=1, every node/.style={transform shape}]
	\newcommand{\vpolCurves}[4]{
		\nextgroupplot[
			\AXISCOL,
			xmin=#3, xmax=#4,
			ymin=-#2, ymax=#2,
			xtick={0, 2*pi, 4*pi, 6*pi, 8*pi, 10*pi, 12*pi},
			xticklabels={$0$, $2\pi$, $4\pi$, $6\pi$, $8\pi$, $10\pi$, $12\pi$},
			legend columns=2
		]
	    \addplot[color=\COLORX, smooth, thick] table [x=0, y=x] {#1};
	    \addplot[color=\COLORXdot, smooth, thick] table [x=0, y=xdot] {#1};
		\legend{$x$, $\dot{x}$};		
	}
	\newcommand{\vpolCurvesNoYLabel}[4]{
		\nextgroupplot[
			\AXISCOL,
			xmin=#3, xmax=#4,
			ymin=-#2, ymax=#2,
			xtick={0, 2*pi, 4*pi, 6*pi, 8*pi, 10*pi, 12*pi},
			xticklabels={$0$, $2\pi$, $4\pi$, $6\pi$, $8\pi$, $10\pi$, $12\pi$},
			legend columns=2,
		]
	    \addplot[color=\COLORX, smooth, thick] table [x=0, y=x] {#1};
	    \addplot[color=\COLORXdot, smooth, thick] table [x=0, y=xdot] {#1};
		\legend{$x$, $\dot{x}$};		
	}
	
	\newcommand{\vpolPhase}[1]{
		\nextgroupplot[
			\AXISCOL,
			% xmin=-3., xmax=3.,
			% ymin=-5., ymax=5.,
			ylabel={$\dot{x}$},
			every axis y label/.style={
	        	at={(ticklabel cs:0.5)},
				rotate=90,
				yshift=.08in,
				anchor=center,
				align=center
	    	}
		]
	    \addplot[color=\COLORPhase, smooth,  thin, opacity=1] table [x=x, y=xdot] {#1};
	}
	\newcommand{\vpolPhaseNoYLabel}[1]{
		\nextgroupplot[
			\AXISCOL,
			% xmin=-3., xmax=3.,
			% ymin=-5., ymax=5.,
		]
	    \addplot[color=\COLORPhase, smooth,  thin, , opacity=1] table [x=x, y=xdot] {#1};
	}
	
	\newcommand{\vpolGamma}[4]{
		\nextgroupplot[
          title={$\gamma(\Delta)$},
          title style={
            font=\rm\sffamily\fontsize{8}{8}\selectfont,
            text=black,
            anchor=west,
            at={(.7,.7)},
            inner sep=1pt,
            draw=none,
            fill=black!5,
            fill opacity=.75,
            align=right,
            text opacity=1,},			\AXISCOL,
			xmin=#2, xmax=#3,
			ymin=-0.05, ymax=#4,
			xtick={0, 2*pi, 4*pi, 6*pi, 8*pi, 10*pi, 12*pi},
			xticklabels={$0$, $2\pi$, $4\pi$, $6\pi$, $8\pi$, $10\pi$, $12\pi$},
			ylabel={$\gamma$},
			every axis y label/.style={
	        	at={(ticklabel cs:0.5)},
				rotate=90,
				yshift=.075in,
				anchor=center,
				align=center
	    	}
		]
	    \addplot[color=\COLORGamma, smooth, thick, ] table [x=0, y=gamma] {#1};
	}
	\newcommand{\vpolGammaNoYLabel}[4]{
		\nextgroupplot[
          title={$\gamma(\Delta)$},
          title style={
            font=\rm\sffamily\fontsize{8}{8}\selectfont,
            text=black,
            anchor=west,
            at={(.7,.7)},
            inner sep=1pt,
            draw=none,
            fill=black!5,
            fill opacity=.75,
            align=right,
            text opacity=1,},			\AXISCOL,
			xmin=#2, xmax=#3,
			ymin=-0.05, ymax=#4,
			xtick={0, 2*pi, 4*pi, 6*pi, 8*pi, 10*pi, 12*pi},
			xticklabels={$0$, $2\pi$, $4\pi$, $6\pi$, $8\pi$, $10\pi$, $12\pi$},
		]
	    \addplot[color=\COLORGamma, smooth, thick, ] table [x=0, y=gamma] {#1};
	}


	%---------------------------------------------Group Plots---------------------------------------	
	\pgfplotstableread[col sep=comma]{datafiles/vpol_0.07_small.dat}{\dataOne}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_0.07_gamma.dat}{\gammaLogOne}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_0.7_small.dat}{\dataTwo}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_0.7_gamma.dat}{\gammaLogTwo}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_1.0_small.dat}{\dataThree}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_1.0_gamma.dat}{\gammaLogThree}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_4.0_small.dat}{\dataFour}
    \pgfplotstableread[col sep=comma]{datafiles/vpol_4.0_gamma.dat}{\gammaLogFour}
	
	\begin{groupplot}[
		group style={
			group size=4 by 3, 
			horizontal sep=\HSEP, 
			vertical sep=\VSEP,
		},
		width=\WDT,
		height=\HGT,
		legend style={
			anchor=west,
			at={(0, 1.2)},
			inner sep=1pt,
			draw=none,
			fill=black!5,
			fill opacity=.75,
			align=right,
			font=\rm\sffamily\fontsize{8}{8}\selectfont,
			text=black,
			text opacity=1,
			/tikz/column 2/.style={column sep=5pt,},
		},
		axis on top=false,
		major tick length=0pt,
		grid,
		grid style={
			opacity=1,
			thick,
			black!15
		},
	]
			
		%--------------------------first row----------------------------	
		\vpolCurves{\dataOne}{2}{-0.5*pi}{6.5*pi}
		\vpolCurvesNoYLabel{\dataTwo}{4}{-0.5*pi}{6.5*pi}
		\vpolCurvesNoYLabel{\dataThree}{4}{-0.5*pi}{6.5*pi}
		\vpolCurvesNoYLabel{\dataFour}{8}{-0.5*pi}{6.5*pi}
		
		%--------------------------second row----------------------------	
		\vpolPhase{\dataOne}
		\vpolPhaseNoYLabel{\dataTwo}
		\vpolPhaseNoYLabel{\dataThree}
		\vpolPhaseNoYLabel{\dataFour}

		%--------------------------third row----------------------------	
		\vpolGamma{\gammaLogOne}{-0.5*pi}{6.5*pi}{1}		
		\vpolGammaNoYLabel{\gammaLogTwo}{-0.5*pi}{6.5*pi}{.75}		
		\vpolGammaNoYLabel{\gammaLogThree}{-0.5*pi}{6.5*pi}{.75}		
		\vpolGammaNoYLabel{\gammaLogFour}{-0.5*pi}{6.5*pi}{1}		
	\end{groupplot}
    
	\node[anchor=north] at ([yshift=-.125in]$(group c1r1.south east)!0.5!(group c4r1.south west)$){time [sec]};
	\node[anchor=north] at ([yshift=-.125in]$(group c1r2.south east)!0.5!(group c4r2.south west)$){$x$};
    \node[anchor=north] at ([yshift=-.125in]$(group c1r3.south east)!0.5!(group c4r3.south west)$){delay [sec]};

\end{tikzpicture}
